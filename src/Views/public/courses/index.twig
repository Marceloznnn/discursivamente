{% extends 'layouts/base.twig' %}

{% block styles %}
  <link rel="stylesheet" href="/assets/css/pages/curso/aluno/index.css">
{% endblock %}

{% block content %}
  {# Se√ß√£o ‚ÄúCursos Gratuitos‚Äù #}
  <section class="free-courses-section">
    <div class="free-image">
      <img src="https://images.unsplash.com/photo-1434030216411-0b793f4b4173?w=500&auto=format&fit=crop&q=60"
           alt="Cursos gratuitos">
    </div>
    <div class="free-content">
      <h2>Todos os nossos cursos s√£o 100% gratuitos</h2>
      <p>
        Acreditamos que o conhecimento deve ser acess√≠vel a todos.  
        Aproveite conte√∫dos de alta qualidade sem custo algum!
      </p>
    </div>
  </section>

  {# Formul√°rio de busca #}
  <form method="get" action="/courses" class="search-form">
    <input
      type="text"
      name="q"
      placeholder="Pesquisar cursos..."
      value="{{ q|e }}"
      class="search-input"
    />
    <button type="submit" class="btn-primary btn-sm">Buscar</button>
    {% if q %}
      <a href="/courses" class="btn-secondary btn-sm">Limpar</a>
    {% endif %}
  </form>

  {# Lista de cursos em cards #}
  <ul class="course-list">
    {% for course in courses %}
      <li class="course-item">
        <img
          src="{{ course.getImage()|default('https://images.pexels.com/photos/355952/pexels-photo-355952.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1') }}"
          alt="{{ course.getTitle() }}"
          class="course-img"
        >
        <div class="content">
          <a href="/courses/{{ course.getId() }}">
            <strong>{{ course.getTitle() }}</strong>
          </a>
          <p>{{ course.getDescription()|slice(0, 100) ~ '...' }}</p>

          <div class="participants">
            üë• {{ participantCounts[course.getId()] }}
            {{ participantCounts[course.getId()] == 1
               ? 'participante'
               : 'participantes' }}
          </div>

          <a href="/courses/{{ course.getId() }}" class="course-cta">
            Saiba mais
          </a>
        </div>
      </li>
    {% else %}
      <li class="empty-state">
        Nenhum curso {{ q
          ? 'encontrado para "' ~ q ~ '"'
          : 'dispon√≠vel' }}.
      </li>
    {% endfor %}
  </ul>
{% endblock %}
