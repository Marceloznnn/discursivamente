{% extends 'layouts/base.twig' %}

{% block styles %}
  <link rel="stylesheet" href="/assets/css/pages/curso/aluno/show.css">
{% endblock %}

{% block content %}
  <div class="course-detail-container">
    <h1>{{ course.title }}</h1>
    <p class="course-description">{{ course.description }}</p>

    <a href="/courses/{{ course.id }}/materials" class="btn-materials">
      Ver Materiais
    </a>

    <div class="comments-section">
      <h2 id="comments">Comentários</h2>
      <ul class="comments-list">
        {% for c in comments %}
          <li class="comment-item">
            <div class="comment-header">
              <strong>{{ c.userName }}</strong>
              <span>{{ c.createdAt|date("d/m/Y H:i") }}</span>
            </div>
            <div class="comment-rating">Avaliação: {{ c.rating }} / 5</div>
            <div class="comment-body">{{ c.comment }}</div>
          </li>
        {% else %}
          <li class="material-empty">Seja o primeiro a comentar!</li>
        {% endfor %}
      </ul>
    </div>

    {% if session.user %}
      <form action="/courses/{{ course.id }}/comment" method="post" class="comment-form">
        <label for="comment">Comentário:</label>
        <textarea id="comment" name="comment" rows="4"></textarea>

        <label for="rating">Avaliação:</label>
        <select id="rating" name="rating">
          {% for i in 1..5 %}
            <option value="{{ i }}">{{ i }} estrela{{ i > 1 ? 's' : '' }}</option>
          {% endfor %}
        </select>

        <button type="submit" class="btn-submit">Enviar comentário</button>
      </form>
    {% else %}
      <p><a href="/login" class="back-link">Faça login para deixar um comentário.</a></p>
    {% endif %}

    <p><a href="/courses" class="back-link">← Voltar a todos os cursos</a></p>
  </div>
{% endblock %}
